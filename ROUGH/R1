@Test
void testDecrypt_InvalidCiphertext_ReturnsNull() throws SafePageException {
    // give an invalid ciphertext (not base64 / not a valid KMS blob)
    String invalidCiphertext = "not-a-valid-ciphertext";
    String result = kmsService.decryptUsingAWSKey(invalidCiphertext);

    assertNull(result, "Should return null when decryption fails");
}

@Test
void testDecrypt_EmptyCiphertext_ThrowsException() {
    SafePageException ex = assertThrows(SafePageException.class,
            () -> kmsService.decryptUsingAWSKey(""));

    assertTrue(ex.getMessage().contains("cipherText is required!"));
}

@Test
void testDecrypt_NullCiphertext_ThrowsException() {
    SafePageException ex = assertThrows(SafePageException.class,
            () -> kmsService.decryptUsingAWSKey(null));

    assertTrue(ex.getMessage().contains("cipherText is required!"));
}

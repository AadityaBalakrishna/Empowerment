package com.mypersonal.aexpconfig.controller;

import org.springframework.beans.factory.config.BeanDefinition;
import org.springframework.context.ConfigurableApplicationContext;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

import java.util.Arrays;
import java.util.List;

@RestController
public class StarterBeanController {

    private final ConfigurableApplicationContext context;

    public StarterBeanController(ConfigurableApplicationContext context) {
        this.context = context;
    }

    @GetMapping("/starter/beans")
    public List<String> getStarterBeans() {
        return Arrays.stream(context.getBeanDefinitionNames())
                .map(name -> {
                    BeanDefinition def = context.getBeanFactory().getBeanDefinition(name);
                    return name + " -> " + def.getResourceDescription();
                })
                .filter(desc -> desc != null && desc.contains("EpwConfigServiceBootstrapConfiguration"))
                .toList();
    }
}


package com.empower.epw.crm.gateway.sqs;

import io.awspring.cloud.sqs.operations.SqsTemplate;
import lombok.CustomLog;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;
import org.springframework.stereotype.Service;

/**
 * A "Producer" service for sending messages to SQS. This component is only created if
 * 'crm.gateway.producer.enabled=true'.
 */
@CustomLog
@Service
@ConditionalOnProperty(name = "crm.gateway.producer.enabled", havingValue = "true")
public class CrmGatewayMessageProducer
{

	private final SqsTemplate sqsTemplate;

	@Autowired
	public CrmGatewayMessageProducer(SqsTemplate sqsTemplate)
	{
		this.sqsTemplate = sqsTemplate;
	}

	/**
	 * Sends a message to a specific queue.
	 * 
	 * @param queueName
	 *            The name of the queue
	 * @param payload
	 *            The string message payload
	 */
	public void sendMessage(String queueName, String payload)
	{
		log.info("Sending message to queue [{}]: {}", queueName, payload);
		sqsTemplate.send(queueName, payload);
		log.info("Message sent successfully to queue [{}].", queueName);
	}
}


make this producer work for queue names, 

the queue names are declared in the config store for each env like this, this ex is from devtrunk env:
crm.gateway.sqs.queue.dryrun=DEVTRUNK_CRM_GATEWAY_DRY_RUN
crm.gateway.sqs.queue.intermediate=DEVTRUNK_CRM_GATEWAY_INTERMEDIATE
crm.gateway.sqs.queue.normal=DEVTRUNK_CRM_GATEWAY_NORMAL
crm.gateway.sqs.queue.top=DEVTRUNK_CRM_GATEWAY_TOP


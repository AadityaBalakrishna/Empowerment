<?xml version="1.0" encoding="UTF-8"?>
<beans default-lazy-init="true" 
       xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:jpa="http://www.springframework.org/schema/data/jpa"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/data/jpa https://www.springframework.org/schema/data/jpa/spring-jpa.xsd">

    <!-- Import the standard legacy configuration file (persistenceApplicationContext.xml) -->
    <import resource="classpath:persistenceApplicationContext.xml" />

    <!-- 
      ISOLATION: We use 'include-filter' to ensure ONLY the SpsCirrusContactMetadataRepository 
      interface is recognized and instantiated as a Spring bean. This prevents context
      contamination that breaks other tests relying on Mockito mocks/spies.
    -->
    <jpa:repositories base-package="com.personalcapital.salesforce.sps.repository" 
                      transaction-manager-ref="spTran">
        <jpa:include-filter type="assignable" expression="com.personalcapital.salesforce.sps.repository.SpsCirrusContactMetadataRepository" />
    </jpa:repositories>

</beans>

// First case: no flagged IP in system (getIPAddress returns null)
when(iPManager.getIPAddress(TEST_IP_ADDRESS)).thenReturn(null);
boolean validated = iPClusteringRule.validate();
Assertions.assertTrue(validated); // ✅ Should pass

// Second case: flagged IP but whitelisted
FlaggedIpAddress ip = new FlaggedIpAddressImpl();
ip.setIpAddrString(TEST_IP_ADDRESS);
ip.setSuspicious(true);
ip.setWhiteListed(true);
when(iPManager.getIPAddress(TEST_IP_ADDRESS)).thenReturn(ip);

user.setSuspicious(false); // reset if it was marked suspicious
validated = iPClusteringRule.validate();
Assertions.assertTrue(validated); // ✅ Should pass

// Third case: flagged IP and NOT whitelisted
ip.setWhiteListed(false);
when(iPManager.getIPAddress(TEST_IP_ADDRESS)).thenReturn(ip);

validated = iPClusteringRule.validate();
Assertions.assertFalse(validated); // ✅ Should pass

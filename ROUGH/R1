@Test
public void testEncryptDecryptUsingSystemPrimaryKey_AWS_2() throws Exception {
	when(keyManager.isSystmePrimaryKeyMigratedToAWS()).thenReturn(true);
	when(keyManager.getSystemPrimaryAliasName())
			.thenReturn("alias/app/pcap/pcap/system_primary/v1");

	String plainSeedValue = rawSystemSecondaryKeySeed;
	String fakeEncryptedSeed = CryptType.SYSTEM_PRIMARY.getVersion() + "fakeEncryptedSeedXYZ";

	// Correct stubbing with matching args
	stubAwsKmsEncryption(plainSeedValue, "fakeEncryptedSeedXYZ");

	String encryptedSystemSecondaryKeySeed = cryptEngine.encrypt(CryptType.SYSTEM_PRIMARY, plainSeedValue);
	assertNotNull(encryptedSystemSecondaryKeySeed);
	assertTrue(encryptedSystemSecondaryKeySeed.startsWith(CryptType.SYSTEM_PRIMARY.getVersion()));

	String decryptedSystemSecondaryKeySeed = cryptEngine.decrypt(CryptType.SYSTEM_PRIMARY, encryptedSystemSecondaryKeySeed);
	assertNotNull(decryptedSystemSecondaryKeySeed);
	assertEquals(plainSeedValue, decryptedSystemSecondaryKeySeed);
}

package com.personalcapital.config;

import com.empower.epw.starter.config.store.EpwConfigServiceBootstrapConfiguration;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.ApplicationContext;
import org.springframework.core.env.Environment;
import org.springframework.test.context.ContextConfiguration;
import org.springframework.test.context.junit.jupiter.SpringJUnitConfig;

@SpringJUnitConfig
@ContextConfiguration(locations = "classpath:pcapConfigApplicationContext.xml")
public class TestConfig {

    @Autowired
    private Environment environment;

    @Autowired
    private EpwConfigServiceBootstrapConfiguration epwConfigService;

    @Test
    public void testProfiles() {
        // Set up environment properties
        System.setProperty("aws.account", "dev");
        System.setProperty("identity.stage", "devtrunk");
        System.setProperty("identity.parentStage", "devstaging");

        // Call the method to infer profiles
        String inferredProfiles = epwConfigService.inferProfiles();

        // Assert the result
        Assertions.assertNotNull(inferredProfiles, "Inferred profiles should not be null");
        Assertions.assertEquals("dev-shared,devstaging,devtrunk", inferredProfiles);

        System.out.println("Inferred Profiles: " + inferredProfiles);
    }
}
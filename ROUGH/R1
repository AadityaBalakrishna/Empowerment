@Test
public void testEncryptDecryptUsingSystemPrimaryKey_AWS_2() throws Exception {
	when(keyManager.isSystmePrimaryKeyMigratedToAWS()).thenReturn(true);
	when(keyManager.getSystemPrimaryAliasName())
		.thenReturn("alias/app/pcap/pcap/system_primary/v1");

	String plainSeedValue = rawSystemSecondaryKeySeed;
	String fakeEncryptedSeed = "fakeEncryptedSeedXYZ";

	when(epwKmsService.encryptUsingAWSKey(eq(plainSeedValue), anyString()))
		.thenReturn(fakeEncryptedSeed);
	when(epwKmsService.decryptUsingAWSKey(eq(fakeEncryptedSeed)))
		.thenReturn(plainSeedValue);

	// Encrypt
	String encryptedSystemSecondaryKeySeed = cryptEngine.encrypt(CryptType.SYSTEM_PRIMARY, plainSeedValue);
	assertNotNull(encryptedSystemSecondaryKeySeed);

	// Decrypt
	String decryptedSystemSecondaryKeySeed = cryptEngine.decrypt(CryptType.SYSTEM_PRIMARY, encryptedSystemSecondaryKeySeed);
	assertEquals(decryptedSystemSecondaryKeySeed, plainSeedValue);
}
